var xrs=function(){"use strict";function n(n,t){return t={exports:{}},n(t,t.exports),t.exports}function t(n){return function(t){return t==n}}function e(n){return function(t){return O(t)(n)}}var r=function(){var n,t,e=new Promise(function(e,r){n=e,t=r});return arguments.length&&n(arguments[0]),e.resolve=n,e.reject=t,e},o=function n(t,e){return e instanceof Array&&(e=e.reduce(n,[])),(t=t||[]).concat(e)},i=function(n,t){return t in n},u=function(n,t,e,r){return n.host&&n.host.nodeName&&(n=n.host),t.name&&(e=t,t=t.name),!i(n,t)&&Object.defineProperty(n,t,{value:e,writable:r}),n[t]},c=function(){},f=function n(t,e){function i(n,e){return n.next?n.next(e):e instanceof Array?n.apply(t,e):n.call(t,e)}function f(n,t){for(var r=n.length;~--r;)t!=n[r]&&t!=n[r].fn&&t||(e.off||c)(n.splice(r,1)[0])}function a(t,e){var o=n((e=e||{}).base||r());return o.i=0,o.li=[],o.fn=e.fn,o.parent=t,o.source=e.fn?o.parent.source:o,o.on("stop",function(n){return o.type?o.parent.off(o.type,o):o.parent.off(o),o.reason=n}),o.each=function(n){var t=n.next?n:a(o,{fn:n});return o.li.push(t),t},o.pipe=function(n){return n(o)},o.map=function(n){return o.each(function(t,e,r){return r.next(n(t,e,r))})},o.filter=function(n){return o.each(function(t,e,r){return n(t,e,r)&&r.next(t)})},o.reduce=function(n,t){return o.each(function(e,r,o){return o.next(t=n(t,e,r,o))})},o.unpromise=function(){var n=a(o,{base:{},fn:function(t){return n.next(t)}});return o.li.push(n),n},o.next=function(n){return o.resolve&&o.resolve(n),o.li.length?o.li.map(function(t){return t.fn(n,t.i++,t)}):n},o.until=function(n){return(n.each||n.then).call(n,function(n){return o.source.emit("stop",n)}),o},o.off=function(n){return f(o.li,n),o},o.start=function(){return o.source.emit("start"),o},o[Symbol.asyncIterator]=function(){return{next:function(){return o.wait=new Promise(function(n){o.wait=!0,o.map(function(t,e,r){delete o.wait,o.off(r),n({value:t,done:!1})}),o.emit("pull",o)})}}},o}return t=t||{},e=e||{},u(t,"emit",function(n,e,r){for(var u=t.on[n.split(".")[0]]||[],c=[],f=0;f<u.length;f++)u[f].ns&&r&&!r(u[f].ns)||c.push(i(u[f].isOnce?u.splice(f--,1)[0]:u[f],e));for(f=0;f<t.on["*"].length;f++)c.push(i(t.on["*"][f],[n,e]));return c.reduce(o,[])},1),u(t,"once",function(n,e){return t.on(n,e,!0)},1),u(t,"off",function(n,e){return f(t.on[n]||[],e),e&&e.ns&&delete t.on[n]["$"+e.ns],t},1),u(t,"on",function(n,r,o){function i(n){return n.isOnce=o,n.type=u,s&&(t.on[u]["$"+(n.ns=s)]=n),l.push(n),(e.on||c)(n),n.next?n:t}var u=n.split(".")[0],s=n.split(".")[1],l=t.on[u]=t.on[u]||[],p="function"==typeof r?r:0;return!p&&s?(p=t.on[u]["$"+s])?p:i(a(t,r)):p||s?p&&s?i((f(l,t.on[u]["$"+s]||-1),p)):!(!p||s)&&i(p):i(a(t,r))},1),t.on["*"]=t.on["*"]||[],t},a=function(n=location.href.replace("http","ws")){const t=f({attempt:0});return t.ready=t.once("connected"),t.connect=p(t,n),t.connect(),t.send=(n=>t.ready.then(t=>t.send(n))),t};const{min:s,pow:l}=Math,p=(n,t)=>()=>{const{WebSocket:e,location:r,setTimeout:o}=window,i=new e(t);i.onopen=(()=>n.emit("connected",i)),i.onmessage=(t=>n.emit("recv",t.data)),i.onclose=(()=>{n.ready=n.once("connected"),n.emit("disconnected"),o(n.connect,d(++n.attempt))})},d=(n,t=100,e=1e4)=>s(e,t*l(2,n));var v=t;t.fn=function(n){return"function"==typeof n},t.str=function(n){return"string"==typeof n},t.num=function(n){return"number"==typeof n},t.obj=function(n){return"object"==typeof n},t.lit=function(n){return n.constructor==Object},t.bol=function(n){return"boolean"==typeof n},t.truthy=function(n){return 1==!!n},t.falsy=function(n){return 0==!!n},t.arr=function(n){return n instanceof Array},t.null=function(n){return null===n},t.def=function(n){return void 0!==n},t.in=function(n){return function(t){return!!n&&(n.indexOf?~n.indexOf(t):t in n)}},t.promise=function(n){return n instanceof Promise},t.stream=function(n){return!(!n||!n.next)};var m=function(n){return Object.keys(v.obj(n)||v.fn(n)?n:{})},h=function(n){return n.__data__},y=function(n){return function(){return n}},x=function(n){return 0===n?"0":n?v.fn(n)?""+n:v.obj(n)?JSON.stringify(n):String(n):""},O=function n(t,e){var r=arguments.length>1,o=v.fn(t)?[]:x(t).split(".").filter(Boolean),i=o.shift();return function(u,c){var f={};return u?v.num(t)||t?v.arr(t)?(t.map(function(t){var r=n(t)(u);void 0!=(r=v.fn(e)?e(r):void 0==r?e:r)&&n(t,v.fn(r)?y(r):r)(f)}),f):u[t]||!o.length?r?(u[t]=v.fn(e)?e(u[t],c):e,u):v.fn(t)?t(u):u[t]:r?(n(o.join("."),e)(u[i]?u[i]:u[i]={}),u):n(o.join("."))(u[i]):r?function(n,t){return m(n).map(function(t){delete n[t]}),m(t).map(function(e){n[e]=t[e]}),n}(u,e):u:void 0}},g=e;e.parent=function(n){return h(this.parentNode)[n]};var b=function(n){return n?m(n).map(g(n)):[]},_=n(function(n){!function(){function t(n){return"object"==typeof n?null===n?"null":n&&1===n.nodeType?"dom":n instanceof Array?"array":n instanceof Date?"date":"object":typeof n}function e(n){var t=arguments.length;if(t<2||null==n)return n;for(var e=1;e<t;e++)for(var r=arguments[e],o=Object.keys(r),i=o.length,u=0;u<i;u++){var c=o[u];void 0===n[c]&&(n[c]=r[c])}return n}function r(n,e,o,c){o.prepare&&o.prepare(n),c=c||[];var f=t(n);if(-1!==s.indexOf(f)){var a=c.indexOf(n);if(-1===a){var p={};c[a=e.push({contents:p,value:u(n)})-1]=n;for(var d in n)o.isSerializable(n,d)&&(p[d]=r(n[d],e,o,c))}return l+a}return i(n)}function o(n,t,e,r){if(r=r||[],a(n,l)){var i=parseInt(n.slice(l.length),10);if(!r.hasOwnProperty(i)){var u=t[i],s=c(u.value),p=u.contents;r[i]=s;for(var d in p)s[d]=o(p[d],t,e,r)}return e.finalize&&e.finalize(r[i]),r[i]}return e.finalize&&e.finalize(n),f(n)}function i(n){var e=t(n);if("undefined"===e)return v;if("function"===e)return d+n.toString();if("date"===e)return m+n.getTime();if(n===1/0)return p;if("dom"!==e)return n}function u(n){var e=t(n);return"function"===e||"date"===e?i(n):"object"===e?h:"array"===e?y:n}function c(n){if("string"===t(n)){if(n===v)return;if(a(n,d))return new Function("return "+n.slice(d.length))();if(a(n,m)){var e=parseInt(n.slice(m.length),10);return new Date(e)}if(a(n,h))return{};if(a(n,y))return[];if(n===p)return 1/0}return n}function f(n){if("string"===t(n)){if(n===v)return;if(a(n,d)){var e=n.slice(d.length),r=e.indexOf("(")+1,o=e.indexOf(")",r),i=e.slice(r,o),u=e.indexOf("{")+1,c=e.lastIndexOf("}")-1,f=e.slice(u,c);return new Function(i,f)}if(a(n,m)){var s=parseInt(n.slice(m.length),10);return new Date(s)}if(n===p)return 1/0}return n}function a(n,e){return"string"===t(n)&&n.slice(0,e.length)===e}var s="object array date function".split(" "),l="_CRYO_REF_",p="_CRYO_INFINITY_",d="_CRYO_FUNCTION_",v="_CRYO_UNDEFINED_",m="_CRYO_DATE_",h="_CRYO_OBJECT_",y="_CRYO_ARRAY_",x={stringify:function(n,t){var o=[],i=r(n,o,t=e((t="function"==typeof t?{prepare:t}:t)||{},{prepare:null,isSerializable:function(n,t){return n.hasOwnProperty(t)}}));return JSON.stringify({root:i,references:o})},parse:function(n,t){var r=JSON.parse(n);return t="function"==typeof t?{finalize:t}:t,t=e(t||{},{finalize:null}),o(r.root,r.references,t)}},O=this;n.exports?n.exports=x:O.Cryo=x}()});return n(function(n){n.exports=function({socket:n=a()}={}){n.id=0;const o=f({socket:n,send:r(n),get subscriptions(){return b(n.on).map(n=>n&&n[0]).filter(n=>n&&n.type&&"$"==n.type[0])}});return n.once("disconnected").map(()=>n.on("connected").map(t(o))),n.on("recv").map(n=>e(n)).each(({id:t,data:e,server:r})=>{const i=n.on[`$${t}`]&&n.on[`$${t}`][0];r?o.emit("recv",{id:t,data:e,server:r}):e.exec?e.exec(i,e.value):n.emit(`$${t}`,e)}),o};const t=n=>()=>n.subscriptions.map(({subscription:t})=>n.socket.send(t)),{parse:e}=_,r=(n,t)=>(e,i)=>{if(e instanceof window.Blob)return o(n,e,i);const u=x(++n.id),c=n.on(`$${u}`),f=(e,r=0)=>n.send(c.source.subscription=x({id:u,data:e,type:t})).then(()=>c.emit("sent",{id:u,count:r}));return e.next?e.map(f).source.emit("start"):f(e),c.source.once("stop").filter(n=>"CLOSED"!=n).map(()=>r(n,"UNSUBSCRIBE")(u).filter((n,t,e)=>e.source.emit("stop","CLOSED"))),c},o=(n,t,e,o=0,i=1024)=>{const u=f().on("recv"),c=e=>()=>o>=t.size?u.emit("sent",{id:e}):(n.send(t.slice(o,o+=i)),window.setTimeout(c(e)));return r(n,"BINARY")({size:t.size,meta:e}).on("sent",({id:n})=>c(n)()).on("progress",n=>u.emit("progress",{received:n,total:t.size})).map(u.next).source.until(u.once("stop")),u}})}();
